<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>7684e98e8b06486b9a3c86fe8bde89c6</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:236}"
id="rBZT2x2mfY8h" data-outputId="ef384b9f-aa67-4fb2-e4d3-927cd2a01c0c">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>siniestros <span class="op">=</span> pd.read_csv(<span class="st">&#39;siniestros_tiny.csv&#39;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>siniestros.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">

  <div id="df-cfc5000d-df56-4c80-8af0-402639157ab7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C_YEAR</th>
      <th>C_MNTH</th>
      <th>C_WDAY</th>
      <th>C_HOUR</th>
      <th>C_SEV</th>
      <th>C_VEHS</th>
      <th>C_CONF</th>
      <th>C_RCFG</th>
      <th>C_WTHR</th>
      <th>C_RSUR</th>
      <th>...</th>
      <th>V_ID</th>
      <th>V_TYPE</th>
      <th>V_YEAR</th>
      <th>P_ID</th>
      <th>P_SEX</th>
      <th>P_AGE</th>
      <th>P_PSN</th>
      <th>P_ISEV</th>
      <th>P_SAFE</th>
      <th>P_USER</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2001</td>
      <td>5</td>
      <td>5</td>
      <td>16</td>
      <td>2</td>
      <td>02</td>
      <td>33</td>
      <td>02</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>01</td>
      <td>01</td>
      <td>1986</td>
      <td>02</td>
      <td>M</td>
      <td>15</td>
      <td>13</td>
      <td>1</td>
      <td>UU</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008</td>
      <td>10</td>
      <td>3</td>
      <td>13</td>
      <td>2</td>
      <td>02</td>
      <td>21</td>
      <td>02</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>02</td>
      <td>05</td>
      <td>2002</td>
      <td>02</td>
      <td>M</td>
      <td>04</td>
      <td>23</td>
      <td>1</td>
      <td>02</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009</td>
      <td>8</td>
      <td>7</td>
      <td>09</td>
      <td>2</td>
      <td>02</td>
      <td>36</td>
      <td>02</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>01</td>
      <td>2004</td>
      <td>02</td>
      <td>F</td>
      <td>17</td>
      <td>21</td>
      <td>2</td>
      <td>02</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2003</td>
      <td>4</td>
      <td>5</td>
      <td>18</td>
      <td>2</td>
      <td>2</td>
      <td>UU</td>
      <td>UU</td>
      <td>U</td>
      <td>U</td>
      <td>...</td>
      <td>2</td>
      <td>01</td>
      <td>1996</td>
      <td>03</td>
      <td>F</td>
      <td>02</td>
      <td>21</td>
      <td>2</td>
      <td>02</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2014</td>
      <td>9</td>
      <td>1</td>
      <td>07</td>
      <td>2</td>
      <td>03</td>
      <td>21</td>
      <td>01</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>01</td>
      <td>2001</td>
      <td>01</td>
      <td>F</td>
      <td>36</td>
      <td>11</td>
      <td>2</td>
      <td>02</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-cfc5000d-df56-4c80-8af0-402639157ab7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-cfc5000d-df56-4c80-8af0-402639157ab7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-cfc5000d-df56-4c80-8af0-402639157ab7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f2b413ff-4837-494c-a0a2-39172e2c86f9">
  <button class="colab-df-quickchart" onclick="quickchart('df-f2b413ff-4837-494c-a0a2-39172e2c86f9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f2b413ff-4837-494c-a0a2-39172e2c86f9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="DxvqZIrORAXa" data-outputId="ff49e15b-c49b-4961-e83b-a853a1533f82">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> columna <span class="kw">in</span> siniestros.columns:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    valores_unicos <span class="op">=</span> siniestros[columna].unique()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;Valores siniestros únicos en la columna </span><span class="sc">{</span>columna<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>valores_unicos<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Valores siniestros únicos en la columna C_YEAR: [2001 2008 2009 2003 2014 2013 1999 2002 2004 2006 2011 2000 2012 2007
 2010 2005]
Valores siniestros únicos en la columna C_MNTH: [&#39;5&#39; &#39;10&#39; &#39;8&#39; &#39;4&#39; &#39;9&#39; &#39;12&#39; &#39;6&#39; &#39;11&#39; &#39;2&#39; &#39;7&#39; &#39;3&#39; &#39;1&#39; &#39;01&#39; &#39;UU&#39; &#39;02&#39;]
Valores siniestros únicos en la columna C_WDAY: [&#39;5&#39; &#39;3&#39; &#39;7&#39; &#39;1&#39; &#39;2&#39; &#39;6&#39; &#39;4&#39; &#39;U&#39;]
Valores siniestros únicos en la columna C_HOUR: [&#39;16&#39; &#39;13&#39; &#39;09&#39; &#39;18&#39; &#39;07&#39; &#39;14&#39; &#39;23&#39; &#39;10&#39; &#39;12&#39; &#39;21&#39; &#39;17&#39; &#39;08&#39; &#39;15&#39; &#39;11&#39;
 &#39;00&#39; &#39;19&#39; &#39;02&#39; &#39;20&#39; &#39;06&#39; &#39;UU&#39; &#39;22&#39; &#39;03&#39; &#39;01&#39; &#39;05&#39; &#39;04&#39;]
Valores siniestros únicos en la columna C_SEV: [2 1]
Valores siniestros únicos en la columna C_VEHS: [&#39;02&#39; &#39;2&#39; &#39;03&#39; &#39;01&#39; &#39;1&#39; &#39;3&#39; &#39;4&#39; &#39;1.0&#39; &#39;05&#39; &#39;6&#39; &#39;04&#39; &#39;3.0&#39; &#39;2.0&#39; &#39;06&#39; &#39;10&#39;
 &#39;5&#39; &#39;7&#39; &#39;14&#39; &#39;07&#39; &#39;08&#39; &#39;17&#39; &#39;58&#39; &#39;46&#39; &#39;9&#39; &#39;44&#39; &#39;8&#39; &#39;5.0&#39; &#39;4.0&#39; &#39;15&#39; &#39;77&#39;
 &#39;24&#39; &#39;36&#39; &#39;19&#39; &#39;22&#39; &#39;11&#39; &#39;25&#39; &#39;57&#39; &#39;12&#39; &#39;09&#39; &#39;20&#39; &#39;27&#39; &#39;35&#39; &#39;21&#39; &#39;UU&#39;]
Valores siniestros únicos en la columna C_CONF: [&#39;33&#39; &#39;21&#39; &#39;36&#39; &#39;UU&#39; &#39;04&#39; &#39;35&#39; &#39;03&#39; &#39;QQ&#39; &#39;06&#39; &#39;24&#39; &#39;22&#39; &#39;31&#39; &#39;02&#39; &#39;01&#39;
 &#39;23&#39; &#39;32&#39; &#39;34&#39; &#39;41&#39; &#39;25&#39; &#39;05&#39;]
Valores siniestros únicos en la columna C_RCFG: [&#39;02&#39; &#39;UU&#39; &#39;01&#39; &#39;QQ&#39; &#39;03&#39; &#39;06&#39; &#39;05&#39; &#39;09&#39; &#39;04&#39; &#39;08&#39; &#39;10&#39;]
Valores siniestros únicos en la columna C_WTHR: [&#39;1&#39; &#39;U&#39; &#39;2&#39; &#39;3&#39; &#39;5&#39; &#39;4&#39; &#39;6&#39; &#39;Q&#39; &#39;7&#39;]
Valores siniestros únicos en la columna C_RSUR: [&#39;1&#39; &#39;U&#39; &#39;5&#39; &#39;2&#39; &#39;Q&#39; &#39;3&#39; &#39;4&#39; &#39;6&#39; &#39;8&#39; &#39;9&#39; &#39;7&#39;]
Valores siniestros únicos en la columna C_RALN: [&#39;1&#39; &#39;U&#39; &#39;4&#39; &#39;2&#39; &#39;3&#39; &#39;Q&#39; &#39;5&#39; &#39;6&#39;]
Valores siniestros únicos en la columna C_TRAF: [&#39;18&#39; &#39;QQ&#39; &#39;01&#39; &#39;UU&#39; &#39;04&#39; &#39;03&#39; &#39;06&#39; &#39;08&#39; &#39;02&#39; &#39;13&#39; &#39;05&#39; &#39;10&#39; &#39;17&#39; &#39;15&#39;
 &#39;12&#39; &#39;16&#39; &#39;07&#39; &#39;11&#39; &#39;09&#39;]
Valores siniestros únicos en la columna V_ID: [&#39;01&#39; &#39;02&#39; &#39;2&#39; &#39;1&#39; &#39;03&#39; &#39;99&#39; &#39;05&#39; &#39;06&#39; &#39;3&#39; &#39;04&#39; &#39;4&#39; &#39;5&#39; &#39;13&#39; &#39;43&#39; &#39;6&#39; &#39;09&#39;
 &#39;08&#39; &#39;8&#39; &#39;34&#39; &#39;24&#39; &#39;07&#39; &#39;11&#39; &#39;14&#39; &#39;48&#39; &#39;10&#39; &#39;17&#39; &#39;31&#39; &#39;UU&#39; &#39;9&#39; &#39;47&#39;]
Valores siniestros únicos en la columna V_TYPE: [&#39;01&#39; &#39;05&#39; &#39;06&#39; &#39;14&#39; &#39;08&#39; &#39;17&#39; &#39;NN&#39; &#39;19&#39; &#39;09&#39; &#39;11&#39; &#39;QQ&#39; &#39;UU&#39; &#39;07&#39; &#39;20&#39;
 &#39;23&#39; &#39;16&#39; &#39;21&#39; &#39;18&#39; &#39;10&#39; &#39;22&#39;]
Valores siniestros únicos en la columna V_YEAR: [&#39;1986&#39; &#39;2002&#39; &#39;2004&#39; &#39;1996&#39; &#39;2001&#39; &#39;1998&#39; &#39;UUUU&#39; &#39;1990&#39; &#39;2000&#39; &#39;2007&#39;
 &#39;1995&#39; &#39;1985&#39; &#39;1997&#39; &#39;2011&#39; &#39;1988&#39; &#39;1994&#39; &#39;2008&#39; &#39;1992&#39; &#39;2005&#39; &#39;1989&#39;
 &#39;2009&#39; &#39;2003&#39; &#39;1999&#39; &#39;2006&#39; &#39;NNNN&#39; &#39;2010&#39; &#39;1987&#39; &#39;1991&#39; &#39;1979&#39; &#39;2013&#39;
 &#39;2012&#39; &#39;1981&#39; &#39;1978&#39; &#39;1993&#39; &#39;1984&#39; &#39;1983&#39; &#39;1980&#39; &#39;2014&#39; &#39;1953&#39; &#39;1982&#39;
 &#39;1969&#39; &#39;1977&#39; &#39;1952&#39; &#39;1975&#39; &#39;2015&#39; &#39;1973&#39; &#39;1972&#39; &#39;1976&#39; &#39;1971&#39; &#39;1970&#39;
 &#39;1964&#39; &#39;1974&#39; &#39;1914&#39; &#39;1956&#39; &#39;1966&#39;]
Valores siniestros únicos en la columna P_ID: [&#39;02&#39; &#39;03&#39; &#39;01&#39; &#39;04&#39; &#39;05&#39; &#39;06&#39; &#39;48&#39; &#39;23&#39; &#39;09&#39; &#39;07&#39; &#39;08&#39; &#39;19&#39; &#39;NN&#39; &#39;21&#39;
 &#39;10&#39; &#39;31&#39; &#39;40&#39; &#39;17&#39; &#39;14&#39; &#39;32&#39; &#39;11&#39; &#39;15&#39; &#39;46&#39; &#39;16&#39; &#39;29&#39; &#39;18&#39; &#39;13&#39;]
Valores siniestros únicos en la columna P_SEX: [&#39;M&#39; &#39;F&#39; &#39;U&#39; &#39;N&#39;]
Valores siniestros únicos en la columna P_AGE: [&#39;15&#39; &#39;04&#39; &#39;17&#39; &#39;02&#39; &#39;36&#39; &#39;67&#39; &#39;25&#39; &#39;20&#39; &#39;57&#39; &#39;82&#39; &#39;19&#39; &#39;18&#39; &#39;45&#39; &#39;29&#39;
 &#39;49&#39; &#39;UU&#39; &#39;37&#39; &#39;46&#39; &#39;31&#39; &#39;22&#39; &#39;59&#39; &#39;35&#39; &#39;41&#39; &#39;28&#39; &#39;55&#39; &#39;69&#39; &#39;50&#39; &#39;13&#39;
 &#39;06&#39; &#39;40&#39; &#39;60&#39; &#39;23&#39; &#39;63&#39; &#39;52&#39; &#39;74&#39; &#39;81&#39; &#39;34&#39; &#39;44&#39; &#39;68&#39; &#39;24&#39; &#39;78&#39; &#39;33&#39;
 &#39;42&#39; &#39;01&#39; &#39;32&#39; &#39;72&#39; &#39;76&#39; &#39;77&#39; &#39;21&#39; &#39;66&#39; &#39;51&#39; &#39;86&#39; &#39;91&#39; &#39;10&#39; &#39;75&#39; &#39;16&#39;
 &#39;61&#39; &#39;56&#39; &#39;07&#39; &#39;85&#39; &#39;80&#39; &#39;62&#39; &#39;30&#39; &#39;09&#39; &#39;53&#39; &#39;38&#39; &#39;64&#39; &#39;65&#39; &#39;26&#39; &#39;48&#39;
 &#39;27&#39; &#39;39&#39; &#39;79&#39; &#39;47&#39; &#39;12&#39; &#39;43&#39; &#39;14&#39; &#39;11&#39; &#39;54&#39; &#39;NN&#39; &#39;83&#39; &#39;87&#39; &#39;08&#39; &#39;58&#39;
 &#39;05&#39; &#39;71&#39; &#39;70&#39; &#39;73&#39; &#39;03&#39; &#39;89&#39; &#39;88&#39; &#39;99&#39; &#39;84&#39; &#39;93&#39; &#39;94&#39; &#39;90&#39; &#39;92&#39; &#39;95&#39;
 &#39;98&#39;]
Valores siniestros únicos en la columna P_PSN: [&#39;13&#39; &#39;23&#39; &#39;21&#39; &#39;11&#39; &#39;32&#39; &#39;22&#39; &#39;96&#39; &#39;12&#39; &#39;99&#39; &#39;31&#39; &#39;UU&#39; &#39;QQ&#39; &#39;98&#39; &#39;33&#39;
 &#39;NN&#39;]
Valores siniestros únicos en la columna P_ISEV: [&#39;1&#39; &#39;2&#39; &#39;N&#39; &#39;3&#39; &#39;U&#39;]
Valores siniestros únicos en la columna P_SAFE: [&#39;UU&#39; &#39;02&#39; &#39;01&#39; &#39;NN&#39; &#39;12&#39; &#39;09&#39; &#39;QQ&#39; &#39;13&#39;]
Valores siniestros únicos en la columna P_USER: [&#39;2&#39; &#39;1&#39; &#39;5&#39; &#39;4&#39; &#39;3&#39; &#39;U&#39;]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="4d6cg0PChWvc" data-outputId="87bffaf4-e26d-4159-e730-0537b005f2dd">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>missing_values_siniestros <span class="op">=</span> siniestros.isnull().<span class="bu">sum</span>()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_values_siniestros)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>C_YEAR    0
C_MNTH    0
C_WDAY    0
C_HOUR    0
C_SEV     0
C_VEHS    0
C_CONF    0
C_RCFG    0
C_WTHR    0
C_RSUR    0
C_RALN    0
C_TRAF    0
V_ID      0
V_TYPE    0
V_YEAR    0
P_ID      0
P_SEX     0
P_AGE     0
P_PSN     0
P_ISEV    0
P_SAFE    0
P_USER    0
dtype: int64
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="mDCPqy85Ar-0" data-outputId="aaec1d47-93be-4d74-b484-23552c11ed17">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>column_names <span class="op">=</span> siniestros.columns.tolist()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(column_names)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;C_YEAR&#39;, &#39;C_MNTH&#39;, &#39;C_WDAY&#39;, &#39;C_HOUR&#39;, &#39;C_SEV&#39;, &#39;C_VEHS&#39;, &#39;C_CONF&#39;, &#39;C_RCFG&#39;, &#39;C_WTHR&#39;, &#39;C_RSUR&#39;, &#39;C_RALN&#39;, &#39;C_TRAF&#39;, &#39;V_ID&#39;, &#39;V_TYPE&#39;, &#39;V_YEAR&#39;, &#39;P_ID&#39;, &#39;P_SEX&#39;, &#39;P_AGE&#39;, &#39;P_PSN&#39;, &#39;P_ISEV&#39;, &#39;P_SAFE&#39;, &#39;P_USER&#39;]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="g0Z6r8nHAEz8" data-outputId="537e016b-9540-44ac-952d-a92095192bb2">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>columns_siniestros <span class="op">=</span> siniestros.dtypes</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>siniestros.replace([<span class="st">&#39;UU&#39;</span>, <span class="st">&#39;NN&#39;</span>, <span class="st">&#39;QQ&#39;</span>, <span class="st">&#39;Q&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;U&#39;</span>, <span class="st">&#39;UUUU&#39;</span>, <span class="st">&#39;NNNN&#39;</span>], np.nan, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> columna <span class="kw">in</span> siniestros.columns:</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    valores_unicos <span class="op">=</span> siniestros[columna].unique()</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;Valores únicos en la columna </span><span class="sc">{</span>columna<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>valores_unicos<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Valores únicos en la columna C_YEAR: [2001 2008 2009 2003 2014 2013 1999 2002 2004 2006 2011 2000 2012 2007
 2010 2005]
Valores únicos en la columna C_MNTH: [&#39;5&#39; &#39;10&#39; &#39;8&#39; &#39;4&#39; &#39;9&#39; &#39;12&#39; &#39;6&#39; &#39;11&#39; &#39;2&#39; &#39;7&#39; &#39;3&#39; &#39;1&#39; &#39;01&#39; nan &#39;02&#39;]
Valores únicos en la columna C_WDAY: [&#39;5&#39; &#39;3&#39; &#39;7&#39; &#39;1&#39; &#39;2&#39; &#39;6&#39; &#39;4&#39; nan]
Valores únicos en la columna C_HOUR: [&#39;16&#39; &#39;13&#39; &#39;09&#39; &#39;18&#39; &#39;07&#39; &#39;14&#39; &#39;23&#39; &#39;10&#39; &#39;12&#39; &#39;21&#39; &#39;17&#39; &#39;08&#39; &#39;15&#39; &#39;11&#39;
 &#39;00&#39; &#39;19&#39; &#39;02&#39; &#39;20&#39; &#39;06&#39; nan &#39;22&#39; &#39;03&#39; &#39;01&#39; &#39;05&#39; &#39;04&#39;]
Valores únicos en la columna C_SEV: [2 1]
Valores únicos en la columna C_VEHS: [&#39;02&#39; &#39;2&#39; &#39;03&#39; &#39;01&#39; &#39;1&#39; &#39;3&#39; &#39;4&#39; &#39;1.0&#39; &#39;05&#39; &#39;6&#39; &#39;04&#39; &#39;3.0&#39; &#39;2.0&#39; &#39;06&#39; &#39;10&#39;
 &#39;5&#39; &#39;7&#39; &#39;14&#39; &#39;07&#39; &#39;08&#39; &#39;17&#39; &#39;58&#39; &#39;46&#39; &#39;9&#39; &#39;44&#39; &#39;8&#39; &#39;5.0&#39; &#39;4.0&#39; &#39;15&#39; &#39;77&#39;
 &#39;24&#39; &#39;36&#39; &#39;19&#39; &#39;22&#39; &#39;11&#39; &#39;25&#39; &#39;57&#39; &#39;12&#39; &#39;09&#39; &#39;20&#39; &#39;27&#39; &#39;35&#39; &#39;21&#39; nan]
Valores únicos en la columna C_CONF: [&#39;33&#39; &#39;21&#39; &#39;36&#39; nan &#39;04&#39; &#39;35&#39; &#39;03&#39; &#39;06&#39; &#39;24&#39; &#39;22&#39; &#39;31&#39; &#39;02&#39; &#39;01&#39; &#39;23&#39; &#39;32&#39;
 &#39;34&#39; &#39;41&#39; &#39;25&#39; &#39;05&#39;]
Valores únicos en la columna C_RCFG: [&#39;02&#39; nan &#39;01&#39; &#39;03&#39; &#39;06&#39; &#39;05&#39; &#39;09&#39; &#39;04&#39; &#39;08&#39; &#39;10&#39;]
Valores únicos en la columna C_WTHR: [&#39;1&#39; nan &#39;2&#39; &#39;3&#39; &#39;5&#39; &#39;4&#39; &#39;6&#39; &#39;7&#39;]
Valores únicos en la columna C_RSUR: [&#39;1&#39; nan &#39;5&#39; &#39;2&#39; &#39;3&#39; &#39;4&#39; &#39;6&#39; &#39;8&#39; &#39;9&#39; &#39;7&#39;]
Valores únicos en la columna C_RALN: [&#39;1&#39; nan &#39;4&#39; &#39;2&#39; &#39;3&#39; &#39;5&#39; &#39;6&#39;]
Valores únicos en la columna C_TRAF: [&#39;18&#39; nan &#39;01&#39; &#39;04&#39; &#39;03&#39; &#39;06&#39; &#39;08&#39; &#39;02&#39; &#39;13&#39; &#39;05&#39; &#39;10&#39; &#39;17&#39; &#39;15&#39; &#39;12&#39; &#39;16&#39;
 &#39;07&#39; &#39;11&#39; &#39;09&#39;]
Valores únicos en la columna V_ID: [&#39;01&#39; &#39;02&#39; &#39;2&#39; &#39;1&#39; &#39;03&#39; &#39;99&#39; &#39;05&#39; &#39;06&#39; &#39;3&#39; &#39;04&#39; &#39;4&#39; &#39;5&#39; &#39;13&#39; &#39;43&#39; &#39;6&#39; &#39;09&#39;
 &#39;08&#39; &#39;8&#39; &#39;34&#39; &#39;24&#39; &#39;07&#39; &#39;11&#39; &#39;14&#39; &#39;48&#39; &#39;10&#39; &#39;17&#39; &#39;31&#39; nan &#39;9&#39; &#39;47&#39;]
Valores únicos en la columna V_TYPE: [&#39;01&#39; &#39;05&#39; &#39;06&#39; &#39;14&#39; &#39;08&#39; &#39;17&#39; nan &#39;19&#39; &#39;09&#39; &#39;11&#39; &#39;07&#39; &#39;20&#39; &#39;23&#39; &#39;16&#39; &#39;21&#39;
 &#39;18&#39; &#39;10&#39; &#39;22&#39;]
Valores únicos en la columna V_YEAR: [&#39;1986&#39; &#39;2002&#39; &#39;2004&#39; &#39;1996&#39; &#39;2001&#39; &#39;1998&#39; nan &#39;1990&#39; &#39;2000&#39; &#39;2007&#39; &#39;1995&#39;
 &#39;1985&#39; &#39;1997&#39; &#39;2011&#39; &#39;1988&#39; &#39;1994&#39; &#39;2008&#39; &#39;1992&#39; &#39;2005&#39; &#39;1989&#39; &#39;2009&#39;
 &#39;2003&#39; &#39;1999&#39; &#39;2006&#39; &#39;2010&#39; &#39;1987&#39; &#39;1991&#39; &#39;1979&#39; &#39;2013&#39; &#39;2012&#39; &#39;1981&#39;
 &#39;1978&#39; &#39;1993&#39; &#39;1984&#39; &#39;1983&#39; &#39;1980&#39; &#39;2014&#39; &#39;1953&#39; &#39;1982&#39; &#39;1969&#39; &#39;1977&#39;
 &#39;1952&#39; &#39;1975&#39; &#39;2015&#39; &#39;1973&#39; &#39;1972&#39; &#39;1976&#39; &#39;1971&#39; &#39;1970&#39; &#39;1964&#39; &#39;1974&#39;
 &#39;1914&#39; &#39;1956&#39; &#39;1966&#39;]
Valores únicos en la columna P_ID: [&#39;02&#39; &#39;03&#39; &#39;01&#39; &#39;04&#39; &#39;05&#39; &#39;06&#39; &#39;48&#39; &#39;23&#39; &#39;09&#39; &#39;07&#39; &#39;08&#39; &#39;19&#39; nan &#39;21&#39; &#39;10&#39;
 &#39;31&#39; &#39;40&#39; &#39;17&#39; &#39;14&#39; &#39;32&#39; &#39;11&#39; &#39;15&#39; &#39;46&#39; &#39;16&#39; &#39;29&#39; &#39;18&#39; &#39;13&#39;]
Valores únicos en la columna P_SEX: [&#39;M&#39; &#39;F&#39; nan]
Valores únicos en la columna P_AGE: [&#39;15&#39; &#39;04&#39; &#39;17&#39; &#39;02&#39; &#39;36&#39; &#39;67&#39; &#39;25&#39; &#39;20&#39; &#39;57&#39; &#39;82&#39; &#39;19&#39; &#39;18&#39; &#39;45&#39; &#39;29&#39;
 &#39;49&#39; nan &#39;37&#39; &#39;46&#39; &#39;31&#39; &#39;22&#39; &#39;59&#39; &#39;35&#39; &#39;41&#39; &#39;28&#39; &#39;55&#39; &#39;69&#39; &#39;50&#39; &#39;13&#39; &#39;06&#39;
 &#39;40&#39; &#39;60&#39; &#39;23&#39; &#39;63&#39; &#39;52&#39; &#39;74&#39; &#39;81&#39; &#39;34&#39; &#39;44&#39; &#39;68&#39; &#39;24&#39; &#39;78&#39; &#39;33&#39; &#39;42&#39;
 &#39;01&#39; &#39;32&#39; &#39;72&#39; &#39;76&#39; &#39;77&#39; &#39;21&#39; &#39;66&#39; &#39;51&#39; &#39;86&#39; &#39;91&#39; &#39;10&#39; &#39;75&#39; &#39;16&#39; &#39;61&#39;
 &#39;56&#39; &#39;07&#39; &#39;85&#39; &#39;80&#39; &#39;62&#39; &#39;30&#39; &#39;09&#39; &#39;53&#39; &#39;38&#39; &#39;64&#39; &#39;65&#39; &#39;26&#39; &#39;48&#39; &#39;27&#39;
 &#39;39&#39; &#39;79&#39; &#39;47&#39; &#39;12&#39; &#39;43&#39; &#39;14&#39; &#39;11&#39; &#39;54&#39; &#39;83&#39; &#39;87&#39; &#39;08&#39; &#39;58&#39; &#39;05&#39; &#39;71&#39;
 &#39;70&#39; &#39;73&#39; &#39;03&#39; &#39;89&#39; &#39;88&#39; &#39;99&#39; &#39;84&#39; &#39;93&#39; &#39;94&#39; &#39;90&#39; &#39;92&#39; &#39;95&#39; &#39;98&#39;]
Valores únicos en la columna P_PSN: [&#39;13&#39; &#39;23&#39; &#39;21&#39; &#39;11&#39; &#39;32&#39; &#39;22&#39; &#39;96&#39; &#39;12&#39; &#39;99&#39; &#39;31&#39; nan &#39;98&#39; &#39;33&#39;]
Valores únicos en la columna P_ISEV: [&#39;1&#39; &#39;2&#39; nan &#39;3&#39;]
Valores únicos en la columna P_SAFE: [nan &#39;02&#39; &#39;01&#39; &#39;12&#39; &#39;09&#39; &#39;13&#39;]
Valores únicos en la columna P_USER: [&#39;2&#39; &#39;1&#39; &#39;5&#39; &#39;4&#39; &#39;3&#39; nan]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:236}"
id="PjcVQbz1M_Gy" data-outputId="3ade4edd-129e-4787-d2b7-aa486205e4b3">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_numeric(df):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> column <span class="kw">in</span> df.columns:</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Try to convert each column to numeric</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            df[column] <span class="op">=</span> pd.to_numeric(df[column])</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If conversion fails, apply one-hot encoding</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> pd.get_dummies(df, columns<span class="op">=</span>[column])</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying the conversion to the siniestros dataset</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>siniestros_numeric <span class="op">=</span> convert_to_numeric(siniestros.copy())</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the first few rows of the converted DataFrame</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>siniestros_numeric.head()</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>siniestros.fillna(<span class="dv">0</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>siniestros.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">

  <div id="df-8607ebdb-1714-4408-96cb-43c34d9a4147" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C_YEAR</th>
      <th>C_MNTH</th>
      <th>C_WDAY</th>
      <th>C_HOUR</th>
      <th>C_SEV</th>
      <th>C_VEHS</th>
      <th>C_CONF</th>
      <th>C_RCFG</th>
      <th>C_WTHR</th>
      <th>C_RSUR</th>
      <th>...</th>
      <th>V_ID</th>
      <th>V_TYPE</th>
      <th>V_YEAR</th>
      <th>P_ID</th>
      <th>P_SEX</th>
      <th>P_AGE</th>
      <th>P_PSN</th>
      <th>P_ISEV</th>
      <th>P_SAFE</th>
      <th>P_USER</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2001</td>
      <td>5</td>
      <td>5</td>
      <td>16</td>
      <td>2</td>
      <td>02</td>
      <td>33</td>
      <td>02</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>01</td>
      <td>01</td>
      <td>1986</td>
      <td>02</td>
      <td>M</td>
      <td>15</td>
      <td>13</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008</td>
      <td>10</td>
      <td>3</td>
      <td>13</td>
      <td>2</td>
      <td>02</td>
      <td>21</td>
      <td>02</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>02</td>
      <td>05</td>
      <td>2002</td>
      <td>02</td>
      <td>M</td>
      <td>04</td>
      <td>23</td>
      <td>1</td>
      <td>02</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009</td>
      <td>8</td>
      <td>7</td>
      <td>09</td>
      <td>2</td>
      <td>02</td>
      <td>36</td>
      <td>02</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>01</td>
      <td>2004</td>
      <td>02</td>
      <td>F</td>
      <td>17</td>
      <td>21</td>
      <td>2</td>
      <td>02</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2003</td>
      <td>4</td>
      <td>5</td>
      <td>18</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>2</td>
      <td>01</td>
      <td>1996</td>
      <td>03</td>
      <td>F</td>
      <td>02</td>
      <td>21</td>
      <td>2</td>
      <td>02</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2014</td>
      <td>9</td>
      <td>1</td>
      <td>07</td>
      <td>2</td>
      <td>03</td>
      <td>21</td>
      <td>01</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>01</td>
      <td>2001</td>
      <td>01</td>
      <td>F</td>
      <td>36</td>
      <td>11</td>
      <td>2</td>
      <td>02</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8607ebdb-1714-4408-96cb-43c34d9a4147')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8607ebdb-1714-4408-96cb-43c34d9a4147 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8607ebdb-1714-4408-96cb-43c34d9a4147');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-493033af-0d12-457c-82fd-6c874a08067f">
  <button class="colab-df-quickchart" onclick="quickchart('df-493033af-0d12-457c-82fd-6c874a08067f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-493033af-0d12-457c-82fd-6c874a08067f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="2K_uBDmBiYq4" data-outputId="529b139f-4f65-4b18-bcdc-ae9fb9520d2f">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>siniestros.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>C_YEAR     int64
C_MNTH    object
C_WDAY    object
C_HOUR    object
C_SEV      int64
C_VEHS    object
C_CONF    object
C_RCFG    object
C_WTHR    object
C_RSUR    object
C_RALN    object
C_TRAF    object
V_ID      object
V_TYPE    object
V_YEAR    object
P_ID      object
P_SEX     object
P_AGE     object
P_PSN     object
P_ISEV    object
P_SAFE    object
P_USER    object
dtype: object</code></pre>
</div>
</div>
<div class="cell code" id="U6X2_mjji6Yb">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>siniestros[<span class="st">&#39;P_SEX&#39;</span>] <span class="op">=</span> siniestros[<span class="st">&#39;P_SEX&#39;</span>].replace({<span class="st">&#39;M&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;F&#39;</span>: <span class="dv">2</span>})</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="e7Wbzs8ExkMZ" data-outputId="91525d03-9877-4671-ae8c-f257c5737eb8">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> siniestros.columns:</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> siniestros[column].dtype <span class="op">==</span> <span class="st">&#39;object&#39;</span>:</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>            siniestros[column] <span class="op">=</span> pd.to_numeric(siniestros[column])</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Column &#39;</span><span class="sc">{</span>column<span class="sc">}</span><span class="ss">&#39; cannot be converted to float64&quot;</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>siniestros.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">
<pre><code>C_YEAR      int64
C_MNTH      int64
C_WDAY      int64
C_HOUR      int64
C_SEV       int64
C_VEHS    float64
C_CONF      int64
C_RCFG      int64
C_WTHR      int64
C_RSUR      int64
C_RALN      int64
C_TRAF      int64
V_ID        int64
V_TYPE      int64
V_YEAR      int64
P_ID        int64
P_SEX       int64
P_AGE       int64
P_PSN       int64
P_ISEV      int64
P_SAFE      int64
P_USER      int64
dtype: object</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:405}"
id="0OC2TBdN_4Of" data-outputId="e9348e6e-3be6-4d32-87e6-bfd5aba2f2f2">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initializing the MinMaxScaler</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying normalization to all columns in the DataFrame</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>siniestros_transform <span class="op">=</span> scaler.fit_transform(siniestros)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a new DataFrame from the scaled data</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>siniestros_scaled <span class="op">=</span> pd.DataFrame(siniestros_transform, columns<span class="op">=</span>siniestros.columns)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the scaled dataset</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>siniestros_scaled.head()</span></code></pre></div>
<div class="output error" data-ename="ValueError"
data-evalue="could not convert string to float: &#39;UU&#39;">
<pre><code>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
&lt;ipython-input-24-ac2caec0ef00&gt; in &lt;cell line: 7&gt;()
      5 
      6 # Applying normalization to all columns in the DataFrame
----&gt; 7 siniestros_transform = scaler.fit_transform(siniestros)
      8 
      9 # Creating a new DataFrame from the scaled data

/usr/local/lib/python3.10/dist-packages/sklearn/utils/_set_output.py in wrapped(self, X, *args, **kwargs)
    138     @wraps(f)
    139     def wrapped(self, X, *args, **kwargs):
--&gt; 140         data_to_wrap = f(self, X, *args, **kwargs)
    141         if isinstance(data_to_wrap, tuple):
    142             # only wrap the first output for cross decomposition

/usr/local/lib/python3.10/dist-packages/sklearn/base.py in fit_transform(self, X, y, **fit_params)
    876         if y is None:
    877             # fit method of arity 1 (unsupervised transformation)
--&gt; 878             return self.fit(X, **fit_params).transform(X)
    879         else:
    880             # fit method of arity 2 (supervised transformation)

/usr/local/lib/python3.10/dist-packages/sklearn/preprocessing/_data.py in fit(self, X, y)
    425         # Reset internal state before fitting
    426         self._reset()
--&gt; 427         return self.partial_fit(X, y)
    428 
    429     def partial_fit(self, X, y=None):

/usr/local/lib/python3.10/dist-packages/sklearn/preprocessing/_data.py in partial_fit(self, X, y)
    464 
    465         first_pass = not hasattr(self, &quot;n_samples_seen_&quot;)
--&gt; 466         X = self._validate_data(
    467             X,
    468             reset=first_pass,

/usr/local/lib/python3.10/dist-packages/sklearn/base.py in _validate_data(self, X, y, reset, validate_separately, **check_params)
    563             raise ValueError(&quot;Validation should be done on X, y or both.&quot;)
    564         elif not no_val_X and no_val_y:
--&gt; 565             X = check_array(X, input_name=&quot;X&quot;, **check_params)
    566             out = X
    567         elif no_val_X and not no_val_y:

/usr/local/lib/python3.10/dist-packages/sklearn/utils/validation.py in check_array(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, estimator, input_name)
    877                     array = xp.astype(array, dtype, copy=False)
    878                 else:
--&gt; 879                     array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
    880             except ComplexWarning as complex_warning:
    881                 raise ValueError(

/usr/local/lib/python3.10/dist-packages/sklearn/utils/_array_api.py in _asarray_with_order(array, dtype, order, copy, xp)
    183     if xp.__name__ in {&quot;numpy&quot;, &quot;numpy.array_api&quot;}:
    184         # Use NumPy API to support order
--&gt; 185         array = numpy.asarray(array, order=order, dtype=dtype)
    186         return xp.asarray(array, copy=copy)
    187     else:

/usr/local/lib/python3.10/dist-packages/pandas/core/generic.py in __array__(self, dtype)
   2068 
   2069     def __array__(self, dtype: npt.DTypeLike | None = None) -&gt; np.ndarray:
-&gt; 2070         return np.asarray(self._values, dtype=dtype)
   2071 
   2072     def __array_wrap__(

ValueError: could not convert string to float: &#39;UU&#39;
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="KGaoXIf9BmZv" data-outputId="28c1d30f-2f88-45fe-982e-519b728bc1e4">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize PCA to retain 95% of the variance</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit and transform the scaled data using PCA</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>siniestros_pca <span class="op">=</span> pca.fit_transform(siniestros_scaled)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># The result, &#39;siniestros_pca&#39;, is an array where each row has been transformed to the new PCA space</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>siniestros_pca_df <span class="op">=</span> pd.DataFrame(siniestros_pca)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>siniestros_pca_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="21">

  <div id="df-b93d9bfe-2ec7-4e2c-b057-af260e4269b5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.336559</td>
      <td>-0.261517</td>
      <td>-0.203475</td>
      <td>0.447564</td>
      <td>0.079929</td>
      <td>0.151120</td>
      <td>0.232712</td>
      <td>-0.110739</td>
      <td>-0.089824</td>
      <td>-0.117895</td>
      <td>-0.151383</td>
      <td>-0.042038</td>
      <td>-0.025674</td>
      <td>0.016223</td>
      <td>-0.141664</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.398633</td>
      <td>-0.050409</td>
      <td>0.268180</td>
      <td>0.222039</td>
      <td>-0.252948</td>
      <td>0.095759</td>
      <td>-0.104878</td>
      <td>0.020122</td>
      <td>0.060414</td>
      <td>-0.279569</td>
      <td>-0.204153</td>
      <td>-0.070819</td>
      <td>0.067090</td>
      <td>-0.008491</td>
      <td>-0.075367</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.313885</td>
      <td>-0.217293</td>
      <td>0.002829</td>
      <td>-0.235902</td>
      <td>-0.270676</td>
      <td>0.174312</td>
      <td>0.597229</td>
      <td>0.232503</td>
      <td>-0.075404</td>
      <td>-0.206332</td>
      <td>-0.106940</td>
      <td>-0.065316</td>
      <td>-0.104112</td>
      <td>-0.009949</td>
      <td>-0.040619</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.404256</td>
      <td>0.239224</td>
      <td>-0.381615</td>
      <td>-0.341173</td>
      <td>0.220179</td>
      <td>-0.428160</td>
      <td>-0.077453</td>
      <td>-0.295749</td>
      <td>0.109634</td>
      <td>-0.375661</td>
      <td>-0.313646</td>
      <td>0.065507</td>
      <td>-0.220013</td>
      <td>-0.123883</td>
      <td>-0.008216</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.528487</td>
      <td>-0.019761</td>
      <td>0.367449</td>
      <td>-0.544050</td>
      <td>-0.142703</td>
      <td>0.133381</td>
      <td>-0.366677</td>
      <td>0.307709</td>
      <td>-0.012433</td>
      <td>-0.119895</td>
      <td>-0.019748</td>
      <td>0.024209</td>
      <td>-0.132900</td>
      <td>-0.034846</td>
      <td>0.040262</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b93d9bfe-2ec7-4e2c-b057-af260e4269b5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b93d9bfe-2ec7-4e2c-b057-af260e4269b5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b93d9bfe-2ec7-4e2c-b057-af260e4269b5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-dbb2e979-322a-42e8-aded-3c2d45f1d03c">
  <button class="colab-df-quickchart" onclick="quickchart('df-dbb2e979-322a-42e8-aded-3c2d45f1d03c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-dbb2e979-322a-42e8-aded-3c2d45f1d03c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="AZdMfsMdC66E" data-outputId="1f4bed22-ae13-442a-ea8c-75b3bb820090">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of the first two principal components</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>siniestros_pca_df[<span class="dv">0</span>], y<span class="op">=</span>siniestros_pca_df[<span class="dv">1</span>])</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;PCA: Scatter Plot of the First Two Principal Components&#39;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Principal Component 1&#39;</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Principal Component 2&#39;</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_f8e7f87def8e424b9e9f9f7a57e21aa2/0685a6a383276401d61bca38198a43dd5b4f4fde.png" /></p>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="BjbCxhwkqDEI" data-outputId="68c2d7e4-c74f-404f-b3b1-e4ac30c5ae68">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pip install umap<span class="op">-</span>learn</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Collecting umap-learn
  Downloading umap-learn-0.5.5.tar.gz (90 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 90.9/90.9 kB 1.4 MB/s eta 0:00:00
etadata (setup.py) ... ent already satisfied: numpy&gt;=1.17 in /usr/local/lib/python3.10/dist-packages (from umap-learn) (1.23.5)
Requirement already satisfied: scipy&gt;=1.3.1 in /usr/local/lib/python3.10/dist-packages (from umap-learn) (1.11.4)
Requirement already satisfied: scikit-learn&gt;=0.22 in /usr/local/lib/python3.10/dist-packages (from umap-learn) (1.2.2)
Requirement already satisfied: numba&gt;=0.51.2 in /usr/local/lib/python3.10/dist-packages (from umap-learn) (0.58.1)
Collecting pynndescent&gt;=0.5 (from umap-learn)
  Downloading pynndescent-0.5.11-py3-none-any.whl (55 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 55.8/55.8 kB 4.8 MB/s eta 0:00:00
ent already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from umap-learn) (4.66.1)
Requirement already satisfied: llvmlite&lt;0.42,&gt;=0.41.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba&gt;=0.51.2-&gt;umap-learn) (0.41.1)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.10/dist-packages (from pynndescent&gt;=0.5-&gt;umap-learn) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn&gt;=0.22-&gt;umap-learn) (3.2.0)
Building wheels for collected packages: umap-learn
  Building wheel for umap-learn (setup.py) ... ap-learn: filename=umap_learn-0.5.5-py3-none-any.whl size=86832 sha256=073ebf10d3931b4ff89d7f8eb4fe9c6ae70fba1bc575a5fe00ec25148e0b795a
  Stored in directory: /root/.cache/pip/wheels/3a/70/07/428d2b58660a1a3b431db59b806a10da736612ebbc66c1bcc5
Successfully built umap-learn
Installing collected packages: pynndescent, umap-learn
Successfully installed pynndescent-0.5.11 umap-learn-0.5.5
</code></pre>
</div>
</div>
<div class="cell markdown" id="tiBuRmlJyI9a">
<p>After trying UMAP, I wasn't able to run it as it gave me a
compatibility error between UMAP and tensorflow. For T-SNE, its
complexity is too high to run in my computer, however I introduced a
sample code to see how I would have calculated it. A plausible solution
would be to reduce the sample size.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:407}"
id="lHOpAaHVD79T" data-outputId="1d487d2f-d063-4cf0-c6a8-f85b67ddab27">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying t-SNE to the scaled data</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>siniestros_tsne <span class="op">=</span> tsne.fit_transform(siniestros_scaled)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a DataFrame for the t-SNE transformed data</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>siniestros_tsne_df <span class="op">=</span> pd.DataFrame(siniestros_tsne, columns<span class="op">=</span>[<span class="st">&#39;TSNE1&#39;</span>, <span class="st">&#39;TSNE2&#39;</span>])</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the first few rows of the t-SNE transformed dataset</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>siniestros_tsne_df.head()</span></code></pre></div>
<div class="output error" data-ename="KeyboardInterrupt" data-evalue="">
<pre><code>---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
&lt;ipython-input-25-9e0c31e4f0f2&gt; in &lt;cell line: 5&gt;()
      3 # Applying t-SNE to the scaled data
      4 tsne = TSNE(n_components=2, random_state=42)
----&gt; 5 siniestros_tsne = tsne.fit_transform(siniestros_scaled)
      6 
      7 # Creating a DataFrame for the t-SNE transformed data

/usr/local/lib/python3.10/dist-packages/sklearn/manifold/_t_sne.py in fit_transform(self, X, y)
   1117         self._validate_params()
   1118         self._check_params_vs_input(X)
-&gt; 1119         embedding = self._fit(X)
   1120         self.embedding_ = embedding
   1121         return self.embedding_

/usr/local/lib/python3.10/dist-packages/sklearn/manifold/_t_sne.py in _fit(self, X, skip_num_points)
   1010         degrees_of_freedom = max(self.n_components - 1, 1)
   1011 
-&gt; 1012         return self._tsne(
   1013             P,
   1014             degrees_of_freedom,

/usr/local/lib/python3.10/dist-packages/sklearn/manifold/_t_sne.py in _tsne(self, P, degrees_of_freedom, n_samples, X_embedded, neighbors, skip_num_points)
   1078             opt_args[&quot;momentum&quot;] = 0.8
   1079             opt_args[&quot;n_iter_without_progress&quot;] = self.n_iter_without_progress
-&gt; 1080             params, kl_divergence, it = _gradient_descent(obj_func, params, **opt_args)
   1081 
   1082         # Save the final number of iterations

/usr/local/lib/python3.10/dist-packages/sklearn/manifold/_t_sne.py in _gradient_descent(objective, p0, it, n_iter, n_iter_check, n_iter_without_progress, momentum, learning_rate, min_gain, min_grad_norm, verbose, args, kwargs)
    397         kwargs[&quot;compute_error&quot;] = check_convergence or i == n_iter - 1
    398 
--&gt; 399         error, grad = objective(p, *args, **kwargs)
    400 
    401         inc = update * grad &lt; 0.0

/usr/local/lib/python3.10/dist-packages/sklearn/manifold/_t_sne.py in _kl_divergence_bh(params, P, degrees_of_freedom, n_samples, n_components, angle, skip_num_points, verbose, compute_error, num_threads)
    278 
    279     grad = np.zeros(X_embedded.shape, dtype=np.float32)
--&gt; 280     error = _barnes_hut_tsne.gradient(
    281         val_P,
    282         X_embedded,

KeyboardInterrupt: 
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:542}"
id="-YRhTsJJHxoY" data-outputId="f5719ced-41c0-456b-c746-37983086bfd5">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans, DBSCAN, AgglomerativeClustering</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># K-means Clustering</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>kmeans_labels <span class="op">=</span> kmeans.fit_predict(siniestros_scaled)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># DBSCAN Clustering</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>dbscan <span class="op">=</span> DBSCAN(eps<span class="op">=</span><span class="fl">0.5</span>, min_samples<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>dbscan_labels <span class="op">=</span> dbscan.fit_predict(siniestros_scaled)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Agglomerative Clustering</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>agg_cluster <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>agg_labels <span class="op">=</span> agg_cluster.fit_predict(siniestros_scaled)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding clustering results to the DataFrame for visualization</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>siniestros_clustered <span class="op">=</span> pd.DataFrame(siniestros_scaled, columns<span class="op">=</span>[<span class="st">&#39;C_SEV&#39;</span>, <span class="st">&#39;C_VEHS&#39;</span>, <span class="st">&#39;P_AGE&#39;</span>])</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>siniestros_clustered[<span class="st">&#39;DBSCAN&#39;</span>] <span class="op">=</span> dbscan_labels</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>siniestros_clustered[<span class="st">&#39;Agglomerative&#39;</span>] <span class="op">=</span> agg_labels</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the clustering results</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>siniestros_clustered, x<span class="op">=</span><span class="st">&#39;C_SEV&#39;</span>, y<span class="op">=</span> <span class="st">&#39;C_VEHS&#39;</span> , hue<span class="op">=</span><span class="st">&#39;KMeans&#39;</span>, palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;K-means Clustering&#39;</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>siniestros_clustered, x<span class="op">=</span><span class="st">&#39;C_SEV&#39;</span>, y<span class="op">=</span><span class="st">&#39;C_VEHS&#39;</span>, hue<span class="op">=</span><span class="st">&#39;DBSCAN&#39;</span>, palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;DBSCAN Clustering&#39;</span>)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>siniestros_clustered, x<span class="op">=</span><span class="st">&#39;C_SEV&#39;</span>, y<span class="op">=</span><span class="st">&#39;C_VEHS&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Agglomerative&#39;</span>, palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Agglomerative Clustering&#39;</span>)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to &#39;auto&#39; in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_f8e7f87def8e424b9e9f9f7a57e21aa2/0eeba80f499da6f204facb9beceb44d36c505d15.png" /></p>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="QRlrjNNruA_d" data-outputId="58a3eced-6adb-4dae-86d7-97c4527faa71">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pip install <span class="op">--</span>upgrade tensorflow umap<span class="op">-</span>learn</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: tensorflow in /usr/local/lib/python3.10/dist-packages (2.15.0)
Collecting tensorflow
  Downloading tensorflow-2.15.0.post1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (475.2 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 475.2/475.2 MB 2.2 MB/s eta 0:00:00
ent already satisfied: umap-learn in /usr/local/lib/python3.10/dist-packages (0.5.5)
Requirement already satisfied: absl-py&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.4.0)
Requirement already satisfied: astunparse&gt;=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.6.3)
Requirement already satisfied: flatbuffers&gt;=23.5.26 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (23.5.26)
Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,&gt;=0.2.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.5.4)
Requirement already satisfied: google-pasta&gt;=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.2.0)
Requirement already satisfied: h5py&gt;=2.9.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.9.0)
Requirement already satisfied: libclang&gt;=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (16.0.6)
Requirement already satisfied: ml-dtypes~=0.2.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.2.0)
Requirement already satisfied: numpy&lt;2.0.0,&gt;=1.23.5 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.23.5)
Requirement already satisfied: opt-einsum&gt;=2.3.2 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.3.0)
Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from tensorflow) (23.2)
Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;5.0.0dev,&gt;=3.20.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.20.3)
Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from tensorflow) (67.7.2)
Requirement already satisfied: six&gt;=1.12.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.16.0)
Requirement already satisfied: termcolor&gt;=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.4.0)
Requirement already satisfied: typing-extensions&gt;=3.6.6 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (4.5.0)
Requirement already satisfied: wrapt&lt;1.15,&gt;=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.14.1)
Requirement already satisfied: tensorflow-io-gcs-filesystem&gt;=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.35.0)
Requirement already satisfied: grpcio&lt;2.0,&gt;=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.60.0)
Requirement already satisfied: tensorboard&lt;2.16,&gt;=2.15 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.15.1)
Requirement already satisfied: tensorflow-estimator&lt;2.16,&gt;=2.15.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.15.0)
Requirement already satisfied: keras&lt;2.16,&gt;=2.15.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.15.0)
Requirement already satisfied: scipy&gt;=1.3.1 in /usr/local/lib/python3.10/dist-packages (from umap-learn) (1.11.4)
Requirement already satisfied: scikit-learn&gt;=0.22 in /usr/local/lib/python3.10/dist-packages (from umap-learn) (1.2.2)
Requirement already satisfied: numba&gt;=0.51.2 in /usr/local/lib/python3.10/dist-packages (from umap-learn) (0.58.1)
Requirement already satisfied: pynndescent&gt;=0.5 in /usr/local/lib/python3.10/dist-packages (from umap-learn) (0.5.11)
Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from umap-learn) (4.66.1)
Requirement already satisfied: wheel&lt;1.0,&gt;=0.23.0 in /usr/local/lib/python3.10/dist-packages (from astunparse&gt;=1.6.0-&gt;tensorflow) (0.42.0)
Requirement already satisfied: llvmlite&lt;0.42,&gt;=0.41.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba&gt;=0.51.2-&gt;umap-learn) (0.41.1)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.10/dist-packages (from pynndescent&gt;=0.5-&gt;umap-learn) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn&gt;=0.22-&gt;umap-learn) (3.2.0)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (2.17.3)
Requirement already satisfied: google-auth-oauthlib&lt;2,&gt;=0.5 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (1.2.0)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (3.5.2)
Requirement already satisfied: requests&lt;3,&gt;=2.21.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (2.31.0)
Requirement already satisfied: tensorboard-data-server&lt;0.8.0,&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (0.7.2)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (3.0.1)
Requirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (5.3.2)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (0.3.0)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (4.9)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib&lt;2,&gt;=0.5-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (1.3.1)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (3.6)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (2.0.7)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (2023.11.17)
Requirement already satisfied: MarkupSafe&gt;=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug&gt;=1.0.1-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (2.1.3)
Requirement already satisfied: pyasn1&lt;0.6.0,&gt;=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (0.5.1)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;2,&gt;=0.5-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (3.2.2)
Installing collected packages: tensorflow
  Attempting uninstall: tensorflow
    Found existing installation: tensorflow 2.15.0
    Uninstalling tensorflow-2.15.0:
      Successfully uninstalled tensorflow-2.15.0
Successfully installed tensorflow-2.15.0.post1
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:545}"
id="WzNHW0wPsph9" data-outputId="3474d87d-3b37-4b4f-8094-08157573364d">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> siniestros[[<span class="st">&#39;C_SEV&#39;</span>, <span class="st">&#39;C_VEHS&#39;</span>, <span class="st">&#39;P_AGE&#39;</span>]]</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> selected_features.dropna()  <span class="co"># Handling missing values</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into training and testing sets</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>X_train, X_test <span class="op">=</span> train_test_split(selected_features, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply t-SNE to training data</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>X_train_tsne <span class="op">=</span> tsne.fit_transform(X_train)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply t-SNE to testing data (fitting on training data)</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>X_test_tsne <span class="op">=</span> tsne.fit_transform(X_test)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Training Data Visualization</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train_tsne[:, <span class="dv">0</span>], y<span class="op">=</span>X_train_tsne[:, <span class="dv">1</span>])</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Training Data t-SNE&#39;</span>)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing Data Visualization</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_test_tsne[:, <span class="dv">0</span>], y<span class="op">=</span>X_test_tsne[:, <span class="dv">1</span>])</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Testing Data t-SNE&#39;</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_f8e7f87def8e424b9e9f9f7a57e21aa2/ef43aa1639b71e1465f95a6d969f4d7655d1f3ba.png" /></p>
</div>
</div>
</body>
</html>
